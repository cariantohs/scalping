<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Crypto Tracker</title>
    <link rel="stylesheet" href="style.css">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Chart.js Financial for candlestick -->
    <script src="https://cdn.jsdelivr.net/npm/chartjs-chart-financial@1.0.0"></script>
</head>
<body>
    <header>
        <div class="logo">Crypto Tracker</div>
        <div class="user-info">
            <span id="username"></span>
            <button id="logout-btn">Logout</button>
        </div>
    </header>
    
    <div class="container">
        <div class="dashboard-header">
            <h1>XAUT-USDT Tracker</h1>
            <div class="price-info">
                <div class="price" id="current-price">Loading...</div>
                <div class="change" id="price-change">0.00%</div>
            </div>
        </div>
        
        <div class="chart-container">
            <canvas id="price-chart"></canvas>
        </div>
        
        <div class="chart-controls">
            <button id="line-chart-btn" class="active">Line Chart</button>
            <button id="candlestick-chart-btn">Candlestick Chart</button>
            <select id="timeframe-select">
                <option value="1h">1 Jam</option>
                <option value="4h">4 Jam</option>
                <option value="24h" selected>24 Jam</option>
                <option value="7d">7 Hari</option>
            </select>
        </div>
        
        <div class="analysis-section">
            <h2>Analisis Teknikal</h2>
            <div class="analysis-grid">
                <div class="analysis-card">
                    <h3>Moving Average (50)</h3>
                    <div id="ma-50">-</div>
                    <div id="ma-50-analysis">-</div>
                </div>
                <div class="analysis-card">
                    <h3>Moving Average (200)</h3>
                    <div id="ma-200">-</div>
                    <div id="ma-200-analysis">-</div>
                </div>
                <div class="analysis-card">
                    <h3>RSI (14)</h3>
                    <div id="rsi">-</div>
                    <div id="rsi-analysis">-</div>
                </div>
                <div class="analysis-card">
                    <h3>Volume 24h</h3>
                    <div id="volume">-</div>
                    <div id="volume-analysis">-</div>
                </div>
            </div>
            
            <div class="summary">
                <h3>Rekomendasi Berdasarkan Analisis</h3>
                <p id="recommendation">Sedang menganalisis data...</p>
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore-compat.js"></script>
    <script src="firebase.js"></script>
    <script src="chart.js"></script>
    <script>
        // Logout functionality
        document.getElementById('logout-btn').addEventListener('click', () => {
            firebase.auth().signOut().then(() => {
                window.location.href = 'index.html';
            });
        });

        // Display username
        firebase.auth().onAuthStateChanged(user => {
            if (user) {
                firebase.firestore().collection('users').doc(user.uid).get()
                    .then(doc => {
                        if (doc.exists) {
                            document.getElementById('username').textContent = doc.data().name;
                        } else {
                            document.getElementById('username').textContent = user.email;
                        }
                    });
            } else {
                window.location.href = 'index.html';
            }
        });

        // Initialize chart
        window.addEventListener('DOMContentLoaded', () => {
            initChart();
        });
    </script>
</body>
</html>
